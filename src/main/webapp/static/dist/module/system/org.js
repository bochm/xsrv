define("module/system/org",["app/common","app/api","app/treetable","app/form"],function(e,t,n,r){function s(n,r,i){e.confirm("","\u662f\u5426\u5220\u9664\u9009\u62e9\u7684\u7ec4\u7ec7\u53ca\u5305\u542b\u7684\u6240\u6709\u5b50\u7ec4\u7ec7?",function(){t.ajax("ADMIN/system/org/delete",n.selectedColumnData("id"),null,function(r,i){t.isError(r)?e.error(t.respMsg(r)):(n.deleteSelectedRow(),e.success(t.respMsg(r)))})})}function o(e){$("table#table-system-org-list").treetable({tid:"id",tpid:"parentId",expandable:!0,expandBtn:!0,columns:i,addEditModal:{title:"\u7ec4\u7ec7\u673a\u6784\u7ef4\u62a4",url:"pages/system/org/org-edit",id:"#system-org-edit"},deleteRecord:s})}function u(e){var t=e.act;$("#system-org-edit-form [name='master.id']").on("change",function(){$("#system-org-edit-form [name='master.name']").val($(this).children(":selected").text())});var n=e.table,r={validate:{},url:"ADMIN/system/org/"+t,fieldOpts:{parentOrgName:{view:{selectedMulti:!1}}},onSuccess:function(e){$.fn.zTree.getZTreeObj("system_org_parentTree").reAsyncChildNodes(null,"refresh"),n.addRow(e)}};t=="edit"&&(r.formData=n.selectedRows()[0],r.submitClear=!1,r.fieldOpts.parentOrgName.param={parentOrg:r.formData.id},r.onSuccess=function(e){$.fn.zTree.getZTreeObj("system_org_parentTree").reAsyncChildNodes(null,"refresh"),n.updateSelectedRow(e)}),$("#system-org-edit-form").initForm(r)}var i=[{data:"name",title:"\u7ec4\u7ec7\u540d\u79f0"},{data:"type",title:"\u7c7b\u578b",render:function(e){return t.getDictName("sys_org_type",e)}},{data:"addr",title:"\u5730\u5740"},{data:"master.name",title:"\u8d1f\u8d23\u4eba"},{data:"status",title:"\u72b6\u6001",render:function(e){return t.getDictName("on_off",e)}}];return{inti_table:o,handleEdit:u,init:function(e){this.inti_table(e)}}});