/*! Responsive 2.1.0
 * 2014-2016 SpryMedia Ltd - datatables.net/license
 */

/**
 * @summary     Responsive
 * @description Responsive tables plug-in for DataTables
 * @version     2.1.0
 * @file        dataTables.responsive.js
 * @author      SpryMedia Ltd (www.sprymedia.co.uk)
 * @contact     www.sprymedia.co.uk/contact
 * @copyright   Copyright 2014-2016 SpryMedia Ltd.
 *
 * This source file is free software, available under the following license:
 *   MIT license - http://datatables.net/license/mit
 *
 * This source file is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.
 *
 * For details please refer to: http://www.datatables.net
 */

(function(e){typeof define=="function"&&define.amd?define(["jquery","datatables.net"],function(t){return e(t,window,document)}):typeof exports=="object"?module.exports=function(t,n){t||(t=window);if(!n||!n.fn.dataTable)n=require("datatables.net")(t,n).$;return e(n,t,t.document)}:e(jQuery,window,document)})(function(e,t,n,r){"use strict";var i=e.fn.dataTable,s=function(t,n){if(!i.versionCheck||!i.versionCheck("1.10.3"))throw"DataTables Responsive requires DataTables 1.10.3 or newer";this.s={dt:new i.Api(t),columns:[],current:[]};if(this.s.dt.settings()[0].responsive)return;n&&typeof n.details=="string"?n.details={type:n.details}:n&&n.details===!1?n.details={type:!1}:n&&n.details===!0&&(n.details={type:"inline"}),this.c=e.extend(!0,{},s.defaults,i.defaults.responsive,n),t.responsive=this,this._constructor()};e.extend(s.prototype,{_constructor:function(){var n=this,r=this.s.dt,s=r.settings()[0],o=e(t).width();r.settings()[0]._responsive=this,e(t).on("resize.dtr orientationchange.dtr",i.util.throttle(function(){var r=e(t).width();r!==o&&(n._resize(),o=r)})),s.oApi._fnCallbackReg(s,"aoRowCreatedCallback",function(t,i,s){e.inArray(!1,n.s.current)!==-1&&e("td, th",t).each(function(t){var i=r.column.index("toData",t);n.s.current[i]===!1&&e(this).css("display","none")})}),r.on("destroy.dtr",function(){r.off(".dtr"),e(r.table().body()).off(".dtr"),e(t).off("resize.dtr orientationchange.dtr"),e.each(n.s.current,function(e,t){t===!1&&n._setColumnVis(e,!0)})}),this.c.breakpoints.sort(function(e,t){return e.width<t.width?1:e.width>t.width?-1:0}),this._classLogic(),this._resizeAuto();var u=this.c.details;u.type!==!1&&(n._detailsInit(),r.on("column-visibility.dtr",function(e,t,r,i){n._classLogic(),n._resizeAuto(),n._resize()}),r.on("draw.dtr",function(){n._redrawChildren()}),e(r.table().node()).addClass("dtr-"+u.type)),r.on("column-reorder.dtr",function(e,t,r){n._classLogic(),n._resizeAuto(),n._resize()}),r.on("column-sizing.dtr",function(){n._resizeAuto(),n._resize()}),r.on("init.dtr",function(t,i,s){n._resizeAuto(),n._resize(),e.inArray(!1,n.s.current)&&r.columns.adjust()}),this._resize()},_columnsVisiblity:function(t){var n=this.s.dt,r=this.s.columns,i,s,o=r.map(function(e,t){return{columnIdx:t,priority:e.priority}}).sort(function(e,t){return e.priority!==t.priority?e.priority-t.priority:e.columnIdx-t.columnIdx}),u=e.map(r,function(n){return n.auto&&n.minWidth===null?!1:n.auto===!0?"-":e.inArray(t,n.includeIn)!==-1}),a=0;for(i=0,s=u.length;i<s;i++)u[i]===!0&&(a+=r[i].minWidth);var f=n.settings()[0].oScroll,l=f.sY||f.sX?f.iBarWidth:0,c=n.table().container().offsetWidth-l,h=c-a;for(i=0,s=u.length;i<s;i++)r[i].control&&(h-=r[i].minWidth);var p=!1;for(i=0,s=o.length;i<s;i++){var d=o[i].columnIdx;u[d]==="-"&&!r[d].control&&r[d].minWidth&&(p||h-r[d].minWidth<0?(p=!0,u[d]=!1):u[d]=!0,h-=r[d].minWidth)}var v=!1;for(i=0,s=r.length;i<s;i++)if(!r[i].control&&!r[i].never&&!u[i]){v=!0;break}for(i=0,s=r.length;i<s;i++)r[i].control&&(u[i]=v);return e.inArray(!0,u)===-1&&(u[0]=!0),u},_classLogic:function(){var t=this,n={},i=this.c.breakpoints,s=this.s.dt,o=s.columns().eq(0).map(function(t){var n=this.column(t),i=n.header().className,o=s.settings()[0].aoColumns[t].responsivePriority;if(o===r){var u=e(n.header()).data("priority");o=u!==r?u*1:1e4}return{className:i,includeIn:[],auto:!1,control:!1,never:i.match(/\bnever\b/)?!0:!1,priority:o}}),u=function(t,n){var r=o[t].includeIn;e.inArray(n,r)===-1&&r.push(n)},a=function(e,n,r,s){var a,f,l;if(!r)o[e].includeIn.push(n);else if(r==="max-"){a=t._find(n).width;for(f=0,l=i.length;f<l;f++)i[f].width<=a&&u(e,i[f].name)}else if(r==="min-"){a=t._find(n).width;for(f=0,l=i.length;f<l;f++)i[f].width>=a&&u(e,i[f].name)}else if(r==="not-")for(f=0,l=i.length;f<l;f++)i[f].name.indexOf(s)===-1&&u(e,i[f].name)};o.each(function(t,n){var r=t.className.split(" "),s=!1;for(var o=0,u=r.length;o<u;o++){var f=e.trim(r[o]);if(f==="all"){s=!0,t.includeIn=e.map(i,function(e){return e.name});return}if(f==="none"||t.never){s=!0;return}if(f==="control"){s=!0,t.control=!0;return}e.each(i,function(e,t){var r=t.name.split("-"),i=new RegExp("(min\\-|max\\-|not\\-)?("+r[0]+")(\\-[_a-zA-Z0-9])?"),o=f.match(i);o&&(s=!0,o[2]===r[0]&&o[3]==="-"+r[1]?a(n,t.name,o[1],o[2]+o[3]):o[2]===r[0]&&!o[3]&&a(n,t.name,o[1],o[2]))})}s||(t.auto=!0)}),this.s.columns=o},_detailsDisplay:function(t,n){var r=this,i=this.s.dt,s=this.c.details;if(s&&s.type!==!1){var o=s.display(t,n,function(){return s.renderer(i,t[0],r._detailsObj(t[0]))});(o===!0||o===!1)&&e(i.table().node()).triggerHandler("responsive-display.dt",[i,t,o,n])}},_detailsInit:function(){var t=this,n=this.s.dt,r=this.c.details;r.type==="inline"&&(r.target="td:first-child, th:first-child"),n.on("draw.dtr",function(){t._tabIndexes()}),t._tabIndexes(),e(n.table().body()).on("keyup.dtr","td, th",function(t){t.keyCode===13&&e(this).data("dtr-keyboard")&&e(this).click()});var i=r.target,s=typeof i=="string"?i:"td, th";e(n.table().body()).on("click.dtr mousedown.dtr mouseup.dtr",s,function(r){if(!e(n.table().node()).hasClass("collapsed"))return;if(!n.row(e(this).closest("tr")).length)return;if(typeof i=="number"){var s=i<0?n.columns().eq(0).length+i:i;if(n.cell(this).index().column!==s)return}var o=n.row(e(this).closest("tr"));r.type==="click"?t._detailsDisplay(o,!1):r.type==="mousedown"?e(this).css("outline","none"):r.type==="mouseup"&&e(this).blur().css("outline","")})},_detailsObj:function(t){var n=this,r=this.s.dt;return e.map(this.s.columns,function(e,i){if(e.never||e.control)return;return{title:r.settings()[0].aoColumns[i].sTitle,data:r.cell(t,i).render(n.c.orthogonal),hidden:r.column(i).visible()&&!n.s.current[i],columnIndex:i,rowIndex:t}})},_find:function(e){var t=this.c.breakpoints;for(var n=0,r=t.length;n<r;n++)if(t[n].name===e)return t[n]},_redrawChildren:function(){var e=this,t=this.s.dt;t.rows({page:"current"}).iterator("row",function(n,r){var i=t.row(r);e._detailsDisplay(t.row(r),!0)})},_resize:function(){var n=this,r=this.s.dt,i=e(t).width(),s=this.c.breakpoints,o=s[0].name,u=this.s.columns,a,f,l=this.s.current.slice();for(a=s.length-1;a>=0;a--)if(i<=s[a].width){o=s[a].name;break}var c=this._columnsVisiblity(o);this.s.current=c;var h=!1;for(a=0,f=u.length;a<f;a++)if(c[a]===!1&&!u[a].never&&!u[a].control){h=!0;break}e(r.table().node()).toggleClass("collapsed",h);var p=!1;r.columns().eq(0).each(function(e,t){c[t]!==l[t]&&(p=!0,n._setColumnVis(e,c[t]))}),p&&(this._redrawChildren(),e(r.table().node()).trigger("responsive-resize.dt",[r,this.s.current]))},_resizeAuto:function(){var t=this.s.dt,n=this.s.columns;if(!this.c.auto)return;if(e.inArray(!0,e.map(n,function(e){return e.auto}))===-1)return;var r=t.table().node().offsetWidth,i=t.columns,s=t.table().node().cloneNode(!1),o=e(t.table().header().cloneNode(!1)).appendTo(s),u=e(t.table().body()).clone(!1,!1).empty().appendTo(s),a=t.columns().header().filter(function(e){return t.column(e).visible()}).to$().clone(!1).css("display","table-cell");e(u).append(e(t.rows({page:"current"}).nodes()).clone(!1)).find("th, td").css("display","");var f=t.table().footer();if(f){var l=e(f.cloneNode(!1)).appendTo(s),c=t.columns().footer().filter(function(e){return t.column(e).visible()}).to$().clone(!1).css("display","table-cell");e("<tr/>").append(c).appendTo(l)}e("<tr/>").append(a).appendTo(o),this.c.details.type==="inline"&&e(s).addClass("dtr-inline collapsed"),e(s).find("[name]").removeAttr("name");var h=e("<div/>").css({width:1,height:1,overflow:"hidden"}).append(s);h.insertBefore(t.table().node()),a.each(function(e){var r=t.column.index("fromVisible",e);n[r].minWidth=this.offsetWidth||0}),h.remove()},_setColumnVis:function(t,n){var r=this.s.dt,i=n?"":"none";e(r.column(t).header()).css("display",i),e(r.column(t).footer()).css("display",i),r.column(t).nodes().to$().css("display",i)},_tabIndexes:function(){var t=this.s.dt,n=t.cells({page:"current"}).nodes().to$(),r=t.settings()[0],i=this.c.details.target;n.filter("[data-dtr-keyboard]").removeData("[data-dtr-keyboard]");var s=typeof i=="number"?":eq("+i+")":i;e(s,t.rows({page:"current"}).nodes()).attr("tabIndex",r.iTabIndex).data("dtr-keyboard",1)}}),s.breakpoints=[{name:"desktop",width:Infinity},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}],s.display={childRow:function(t,n,r){if(!n)return t.child.isShown()?(t.child(!1),e(t.node()).removeClass("parent"),!1):(t.child(r(),"child").show(),e(t.node()).addClass("parent"),!0);if(e(t.node()).hasClass("parent"))return t.child(r(),"child").show(),!0},childRowImmediate:function(t,n,r){return!n&&t.child.isShown()||!t.responsive.hasHidden()?(t.child(!1),e(t.node()).removeClass("parent"),!1):(t.child(r(),"child").show(),e(t.node()).addClass("parent"),!0)},modal:function(t){return function(r,i,s){if(!i){var o=function(){u.remove(),e(n).off("keypress.dtr")},u=e('<div class="dtr-modal"/>').append(e('<div class="dtr-modal-display"/>').append(e('<div class="dtr-modal-content"/>').append(s())).append(e('<div class="dtr-modal-close">&times;</div>').click(function(){o()}))).append(e('<div class="dtr-modal-background"/>').click(function(){o()})).appendTo("body");e(n).on("keyup.dtr",function(e){e.keyCode===27&&(e.stopPropagation(),o())})}else e("div.dtr-modal-content").empty().append(s());t&&t.header&&e("div.dtr-modal-content").prepend("<h2>"+t.header(r)+"</h2>")}}},s.renderer={listHidden:function(){return function(t,n,r){var i=e.map(r,function(e){return e.hidden?'<li data-dtr-index="'+e.columnIndex+'" data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'">'+'<span class="dtr-title">'+e.title+"</span> "+'<span class="dtr-data">'+e.data+"</span>"+"</li>":""}).join("");return i?e('<ul data-dtr-index="'+n+'"/>').append(i):!1}},tableAll:function(t){return t=e.extend({tableClass:""},t),function(n,r,i){var s=e.map(i,function(e){return'<tr data-dt-row="'+e.rowIndex+'" data-dt-column="'+e.columnIndex+'">'+"<td>"+e.title+":"+"</td> "+"<td>"+e.data+"</td>"+"</tr>"}).join("");return e('<table class="'+t.tableClass+'" width="100%"/>').append(s)}}},s.defaults={breakpoints:s.breakpoints,auto:!0,details:{display:s.display.childRow,renderer:s.renderer.listHidden(),target:0,type:"inline"},orthogonal:"display"};var o=e.fn.dataTable.Api;return o.register("responsive()",function(){return this}),o.register("responsive.index()",function(t){return t=e(t),{column:t.data("dtr-index"),row:t.parent().data("dtr-index")}}),o.register("responsive.rebuild()",function(){return this.iterator("table",function(e){e._responsive&&e._responsive._classLogic()})}),o.register("responsive.recalc()",function(){return this.iterator("table",function(e){e._responsive&&(e._responsive._resizeAuto(),e._responsive._resize())})}),o.register("responsive.hasHidden()",function(){var t=this.context[0];return t._responsive?e.inArray(!1,t._responsive.s.current)!==-1:!1}),s.version="2.1.0",e.fn.dataTable.Responsive=s,e.fn.DataTable.Responsive=s,e(n).on("preInit.dt.dtr",function(t,n,r){if(t.namespace!=="dt")return;if(e(n.nTable).hasClass("responsive")||e(n.nTable).hasClass("dt-responsive")||n.oInit.responsive||i.defaults.responsive){var o=n.oInit.responsive;o!==!1&&new s(n,e.isPlainObject(o)?o:{})}}),s});