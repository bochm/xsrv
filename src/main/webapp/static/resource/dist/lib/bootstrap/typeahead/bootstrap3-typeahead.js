/* =============================================================
 * bootstrap3-typeahead.js v4.0.2
 * https://github.com/bassjobsen/Bootstrap-3-Typeahead
 * =============================================================
 * Original written by @mdo and @fat
 * =============================================================
 * Copyright 2014 Bass Jobsen @bassjobsen
 *
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

(function(e,t){"use strict";typeof module!="undefined"&&module.exports?module.exports=t(require("jquery")):typeof define=="function"&&define.amd?define(["jquery"],function(e){return t(e)}):t(e.jQuery)})(this,function(e){"use strict";var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.defaults,r),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect=typeof this.options.autoSelect=="boolean"?this.options.autoSelect:!0,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.source=this.options.source,this.delay=this.options.delay,this.$menu=e(this.options.menu),this.$appendTo=this.options.appendTo?e(this.options.appendTo):null,this.fitToElement=typeof this.options.fitToElement=="boolean"?this.options.fitToElement:!1,this.shown=!1,this.listen(),this.showHintOnFocus=typeof this.options.showHintOnFocus=="boolean"||this.options.showHintOnFocus==="all"?this.options.showHintOnFocus:!1,this.afterSelect=this.options.afterSelect,this.addItem=!1,this.value=this.$element.val()||this.$element.text(),this.keyPressed=!1};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").data("value");this.$element.data("active",e);if(this.autoSelect||e){var t=this.updater(e);t||(t=""),this.$element.val(this.displayText(t)||t).text(this.displayText(t)||t).change(),this.afterSelect(t)}return this.hide()},updater:function(e){return e},setSource:function(e){this.source=e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight}),n=typeof this.options.scrollHeight=="function"?this.options.scrollHeight.call():this.options.scrollHeight,r;this.shown?r=this.$menu:this.$appendTo?(r=this.$menu.appendTo(this.$appendTo),this.hasSameParent=this.$appendTo.is(this.$element.parent())):(r=this.$menu.insertAfter(this.$element),this.hasSameParent=!0);if(!this.hasSameParent){r.css("position","fixed");var i=this.$element.offset();t.top=i.top,t.left=i.left}var s=e(r).parent().hasClass("dropup"),o=s?"auto":t.top+t.height+n,u=e(r).hasClass("dropdown-menu-right"),a=u?"auto":t.left;return r.css({top:o,left:a}).show(),this.options.fitToElement===!0&&r.css("width",this.$element.outerWidth()+"px"),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;typeof t!="undefined"&&t!==null?this.query=t:this.query=this.$element.val()||this.$element.text()||"";if(this.query.length<this.options.minLength&&!this.options.showHintOnFocus)return this.shown?this.hide():this;var r=e.proxy(function(){e.isFunction(this.source)&&this.source.length===3?this.source(this.query,e.proxy(this.process,this),e.proxy(this.process,this)):e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(r,this.delay)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),!t.length&&!this.options.addItem?this.shown?this.hide():this:(t.length>0?this.$element.data("active",t[0]):this.$element.data("active",null),this.options.items!="all"&&(t=t.slice(0,this.options.items)),this.options.addItem&&t.push(this.options.addItem),this.render(t).show())},matcher:function(e){var t=this.displayText(e);return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift()){var s=this.displayText(i);s.toLowerCase().indexOf(this.query.toLowerCase())?~s.indexOf(this.query)?n.push(i):r.push(i):t.push(i)}return t.concat(n,r)},highlighter:function(e){var t=this.query;if(t==="")return e;var n=e.match(/(>)([^<]*)(<)/g),r=[],i=[],s;if(n&&n.length)for(s=0;s<n.length;++s)n[s].length>2&&r.push(n[s]);else r=[],r.push(e);var o=new RegExp(t,"g"),u;for(s=0;s<r.length;++s)u=r[s].match(o),u&&u.length>0&&i.push(r[s]);for(s=0;s<i.length;++s)e=e.replace(i[s],i[s].replace(o,"<strong>$&</strong>"));return e},render:function(t){var n=this,r=this,i=!1,s=[],o=n.options.separator;return e.each(t,function(e,n){e>0&&n[o]!==t[e-1][o]&&s.push({__type:"divider"}),n[o]&&(e===0||n[o]!==t[e-1][o])&&s.push({__type:"category",name:n[o]}),s.push(n)}),t=e(s).map(function(t,s){if((s.__type||false)=="category")return e(n.options.headerHtml).text(s.name)[0];if((s.__type||false)=="divider")return e(n.options.headerDivider)[0];var o=r.displayText(s);return t=e(n.options.item).data("value",s),t.find("a").html(n.highlighter(o,s)),o==r.$element.val()&&(t.addClass("active"),r.$element.data("active",s),i=!0),t[0]}),this.autoSelect&&!i&&(t.filter(":not(.dropdown-header)").first().addClass("active"),this.$element.data("active",t.first().data("value"))),this.$menu.html(t),this},displayText:function(e){return typeof e!="undefined"&&typeof e.name!="undefined"?e.name:e},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("propertychange input",e.proxy(this.input,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this)).on("mousedown",e.proxy(this.mousedown,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.off("focus").off("blur").off("keypress").off("propertychange input").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove(),this.destroyed=!0},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t=typeof this.$element[e]=="function"),t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.shiftKey)return;e.preventDefault(),this.prev();break;case 40:if(e.shiftKey)return;e.preventDefault(),this.next()}},keydown:function(t){this.keyPressed=!0,this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),!this.shown&&t.keyCode==40?this.lookup():this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},input:function(e){var t=this.$element.val()||this.$element.text();this.value!==t&&(this.value=t,this.lookup())},keyup:function(e){if(this.destroyed)return;switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:if(!this.shown||this.showHintOnFocus&&!this.keyPressed)return;this.select();break;case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide()}},focus:function(e){this.focused||(this.focused=!0,this.keyPressed=!1,this.options.showHintOnFocus&&this.skipShowHintOnFocus!==!0&&(this.options.showHintOnFocus==="all"?this.lookup(""):this.lookup())),this.skipShowHintOnFocus&&(this.skipShowHintOnFocus=!1)},blur:function(e){!this.mousedover&&!this.mouseddown&&this.shown?(this.hide(),this.focused=!1,this.keyPressed=!1):this.mouseddown&&(this.skipShowHintOnFocus=!0,this.$element.focus(),this.mouseddown=!1)},click:function(e){e.preventDefault(),this.skipShowHintOnFocus=!0,this.select(),this.$element.focus(),this.hide()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},mousedown:function(e){this.mouseddown=!0,this.$menu.one("mouseup",function(e){this.mouseddown=!1}.bind(this))}};var n=e.fn.typeahead;e.fn.typeahead=function(n){var r=arguments;return typeof n=="string"&&n=="getActive"?this.data("active"):this.each(function(){var i=e(this),s=i.data("typeahead"),o=typeof n=="object"&&n;s||i.data("typeahead",s=new t(this,o)),typeof n=="string"&&s[n]&&(r.length>1?s[n].apply(s,Array.prototype.slice.call(r,1)):s[n]())})},t.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a class="dropdown-item" href="#" role="option"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:e.noop,addItem:!1,delay:0,separator:"category",headerHtml:'<li class="dropdown-header"></li>',headerDivider:'<li class="divider" role="separator"></li>'},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;n.typeahead(n.data())})});